{"ast":null,"code":"var _jsxFileName = \"/opt/lampp/htdocs/git/salonreact/src/pages/products/form/ProductAddForm.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useTranslation } from \"react-i18next\"; // validation Formik\n\nimport * as Yup from \"yup\";\nimport { Formik } from \"formik\";\nimport config from \"../../../config\";\nimport yupconfig from \"../../../yupconfig\";\nimport { InputField, SwitchField, InputFieldImage, TextareaField, ReactSelectField } from \"../../../component/form/Field\";\nimport { sweatalert } from \"../../../component/Sweatalert2\"; // import { closeNewSupplierForm } from \"../../../store/slices/supplierSlice\";\n\nimport { productManageStock, closeAddProductForm, productStoreApi } from \"../../../store/slices/productSlice\";\nimport { removeImage } from \"../../../store/slices/imageSlice\";\nimport useScriptRef from \"../../../hooks/useScriptRef\";\nimport CustomSelect from \"../../../component/form/CustomSelect\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ProductAddForm = () => {\n  _s();\n\n  const [loading, setLoading] = useState(false);\n  const rightDrawerOpened = useSelector(state => state.product.isOpenedAddForm);\n  const isProductManageStock = useSelector(state => state.product.isProductManageStock);\n  const isSupplierOption = useSelector(state => state.supplier.isSupplierOption);\n  const isTaxOption = useSelector(state => state.tax.isTaxOption);\n  const {\n    t\n  } = useTranslation();\n  const dispatch = useDispatch();\n  const scriptedRef = useScriptRef();\n\n  const handleCloseAddProductForm = () => {\n    dispatch(closeAddProductForm());\n    dispatch({\n      type: \"product/detail/rejected\"\n    });\n    dispatch(removeImage());\n  };\n\n  const initialValues = {\n    image: \"\",\n    name: \"\",\n    sku: \"\",\n    description: \"\",\n    cost_price: \"\",\n    retail_price: \"\",\n    manage_stock: '',\n    stock_quantity: \"\",\n    low_stock_threshold: \"\",\n    tax_id: \"\",\n    supplier_id: \"\"\n  };\n\n  const digitOnly = value => /^\\d+$/.test(value);\n\n  const decimalOnly = value => /^\\d{1,6}(\\.\\d{1,2})?$/.test(value);\n\n  const validationSchema = Yup.object().shape({\n    image: Yup.mixed().nullable(),\n    name: Yup.string().max(100).label(t(\"product_name\")).trim().required(),\n    sku: Yup.string().trim().label(t(\"sku\")).required(),\n    description: Yup.string().trim().label(t(\"description\")).required(),\n    cost_price: Yup.string().trim().label(t(\"cost_price\")).required().test(\"Decimal only\", t(\"The_field_should_have_decimal_only\"), decimalOnly),\n    retail_price: Yup.string().trim().label(t(\"retail_price\")).required().test(\"Decimal only\", t(\"The_field_should_have_decimal_only\"), decimalOnly),\n    manage_stock: Yup.mixed().nullable(),\n    stock_quantity: Yup.string().when(\"manage_stock\", {\n      is: '1',\n      then: Yup.string().trim().label(t(\"stock_quantity\")).required().test(\"Digits only\", t(\"The_field_should_have_digits_only\"), digitOnly).nullable()\n    }),\n    low_stock_threshold: Yup.string().when(\"manage_stock\", {\n      is: '1',\n      then: Yup.string().trim().label(t(\"low_stock_threshold\")).required().test(\"Digits only\", t(\"The_field_should_have_digits_only\"), digitOnly).nullable()\n    }),\n    tax_id: Yup.lazy(val => Array.isArray(val) ? Yup.array().of(Yup.string()).nullable().min(1).required() : Yup.string().nullable().label(t(\"tax\")).required()),\n    supplier_id: Yup.lazy(val => Array.isArray(val) ? Yup.array().of(Yup.string()).nullable().min(1).required() : Yup.string().nullable().label(t(\"supplier\")).required())\n  });\n  yupconfig();\n\n  const handleSupplierSubmit = (values, _ref) => {\n    let {\n      setErrors,\n      setStatus,\n      setSubmitting,\n      resetForm\n    } = _ref;\n    setLoading(true);\n\n    try {\n      dispatch(productStoreApi(values)).then(action => {\n        if (action.meta.requestStatus == \"fulfilled\") {\n          setStatus({\n            success: true\n          });\n          resetForm();\n          dispatch(removeImage());\n          dispatch(closeAddProductForm());\n          sweatalert({\n            title: t(\"created\"),\n            text: t(\"created_successfully\"),\n            icon: \"success\"\n          });\n        } else if (action.meta.requestStatus == \"rejected\") {\n          const status = action.payload && action.payload.status;\n          const errors = action.payload && action.payload.message && action.payload.message.errors;\n\n          if (status == 422) {\n            setErrors(errors);\n          }\n\n          setStatus({\n            success: false\n          });\n          setSubmitting(false);\n        }\n      });\n\n      if (scriptedRef.current) {\n        setLoading(false);\n      }\n    } catch (err) {\n      if (scriptedRef.current) {\n        setErrors(err.message);\n      }\n\n      setStatus({\n        success: false\n      });\n      setLoading(false);\n    }\n  };\n\n  const supplierOptionsData = isSupplierOption;\n  const taxOptionsData = isTaxOption;\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Formik, {\n      enableReinitialize: false,\n      initialValues: initialValues,\n      validationSchema: validationSchema,\n      onSubmit: handleSupplierSubmit,\n      children: formik => {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: (rightDrawerOpened ? \"full-screen-drawer p-0 \" : '') + rightDrawerOpened,\n          id: \"addproduct-drawer\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"drawer-wrp position-relative\",\n            children: /*#__PURE__*/_jsxDEV(\"form\", {\n              noValidate: true,\n              onSubmit: formik.handleSubmit,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"drawer-header px-md-4 px-3 py-3 d-flex flex-wrap align-items-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"mb-0 fw-semibold\",\n                  children: t(\"new_product\")\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 117,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"ms-auto\",\n                  children: [/*#__PURE__*/_jsxDEV(\"a\", {\n                    className: \"close btn me-1 cursor-pointer\",\n                    onClick: handleCloseAddProductForm,\n                    children: t(\"cancel\")\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 119,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    type: \"submit\",\n                    className: \"btn\",\n                    children: t(\"save\")\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 122,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 118,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 116,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"drawer-body\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col-xxl-6 col-xl-10 col-md-12 mx-auto add-form px-md-4 px-1 py-lg-5 py-3\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"row mx-0\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"col-md-6 ps-md-0 mb-md-0 mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                        className: \"fw-semibold mb-2\",\n                        children: t(\"description\")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 131,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                        children: t(\"add_the_name_and_general_details_of_this_product\")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 132,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(InputFieldImage, {\n                        name: \"image\",\n                        accept: \"image/*\",\n                        label: t(\"add_product_image\"),\n                        page: \"product-form\",\n                        controlId: \"productForm-logo\",\n                        imagname: \"\",\n                        imageurl: \"\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 133,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 130,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"col-md-6 pe-md-0\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"mb-3\",\n                        children: /*#__PURE__*/_jsxDEV(InputField, {\n                          type: \"text\",\n                          name: \"name\",\n                          value: formik.values.name,\n                          label: t(\"product_name\"),\n                          controlId: \"productForm-name\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 137,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 136,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"mb-3\",\n                        children: /*#__PURE__*/_jsxDEV(InputField, {\n                          type: \"text\",\n                          name: \"sku\",\n                          value: formik.values.sku,\n                          label: t(\"sku\"),\n                          controlId: \"productForm-sku\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 140,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 139,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"mb-3\",\n                        children: /*#__PURE__*/_jsxDEV(ReactSelectField, {\n                          name: \"supplier_id\",\n                          placeholder: t(\"search_option\"),\n                          value: formik.values.supplier_id,\n                          options: supplierOptionsData,\n                          label: t(\"supplier\"),\n                          controlId: \"productForm-supplier_id\",\n                          isMulti: false\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 143,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 142,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"mb-3\",\n                        children: /*#__PURE__*/_jsxDEV(TextareaField, {\n                          name: \"description\",\n                          value: formik.values.description,\n                          label: t(\"description\"),\n                          controlId: \"productForm-description\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 146,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 145,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 135,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 129,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n                    className: \"drawer-supplier-hr\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 150,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"row mx-0\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"col-md-6 ps-md-0 mb-md-0 mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                        className: \"fw-semibold mb-2\",\n                        children: t(\"price\")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 153,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                        children: t(\"add_the_pricing_details_of_this_product\")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 154,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 152,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"col-md-6 pe-md-0\",\n                      children: /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"row\",\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"mb-2 col-md-4 col-6 mb-3\",\n                          children: /*#__PURE__*/_jsxDEV(InputField, {\n                            type: \"text\",\n                            name: \"cost_price\",\n                            value: formik.values.cost_price,\n                            label: t(\"cost_price\"),\n                            controlId: \"productForm-cost_price\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 159,\n                            columnNumber: 31\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 158,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"mb-2 col-md-4 col-6 mb-3\",\n                          children: /*#__PURE__*/_jsxDEV(InputField, {\n                            type: \"text\",\n                            name: \"retail_price\",\n                            value: formik.values.retail_price,\n                            label: t(\"retail_price\"),\n                            controlId: \"productForm-retail_price\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 162,\n                            columnNumber: 31\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 161,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"col-md-8 mb-3\",\n                          children: /*#__PURE__*/_jsxDEV(ReactSelectField, {\n                            name: \"tax_id\",\n                            placeholder: t(\"search_option\"),\n                            value: formik.values.tax_id,\n                            options: taxOptionsData,\n                            label: t(\"tax\"),\n                            controlId: \"productForm-tax_id\",\n                            isMulti: false\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 165,\n                            columnNumber: 31\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 164,\n                          columnNumber: 29\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 157,\n                        columnNumber: 27\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 156,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 151,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n                    className: \"drawer-supplier-hr\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 170,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"row mx-0\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"col-md-6 ps-md-0 mb-md-0 mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                        className: \"fw-semibold mb-2\",\n                        children: t(\"inventory\")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 173,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                        children: t(\"manage_stock_levels_of_this_product\")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 174,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 172,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"col-md-6 pe-md-0\",\n                      children: [/*#__PURE__*/_jsxDEV(SwitchField, {\n                        name: \"manage_stock\",\n                        label: t(\"manage_stock\"),\n                        controlId: \"clientForm-manage_stock\",\n                        value: '1',\n                        onChange: e => {\n                          if (e.currentTarget.checked) {\n                            setTimeout(() => {\n                              formik.setFieldValue('manage_stock', '1', false);\n                            }, 100);\n                          } else {\n                            setTimeout(() => {\n                              formik.setFieldValue('manage_stock', '', false);\n                            }, 100);\n                          }\n\n                          formik.handleChange(e);\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 177,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"row\",\n                        style: {\n                          display: formik.values.manage_stock == \"\" || formik.values.manage_stock == 0 ? \"none\" : \"\"\n                        },\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"mb-3 col-md-6\",\n                          children: /*#__PURE__*/_jsxDEV(InputField, {\n                            type: \"text\",\n                            name: \"stock_quantity\",\n                            value: formik.values.stock_quantity,\n                            label: t(\"stock_quantity\"),\n                            controlId: \"productForm-stock_quantity\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 197,\n                            columnNumber: 31\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 196,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"mb-3 col-md-6\",\n                          children: /*#__PURE__*/_jsxDEV(InputField, {\n                            type: \"text\",\n                            name: \"low_stock_threshold\",\n                            value: formik.values.low_stock_threshold,\n                            label: t(\"low_stock_threshold\"),\n                            controlId: \"productForm-low_stock_threshold\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 200,\n                            columnNumber: 31\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 199,\n                          columnNumber: 29\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 195,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 176,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 171,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 128,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 13\n        }, this);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ProductAddForm, \"qmJ+ETXTvyEHkKHAb387vsh1W3U=\", false, function () {\n  return [useSelector, useSelector, useSelector, useSelector, useTranslation, useDispatch, useScriptRef];\n});\n\n_c = ProductAddForm;\nexport default ProductAddForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductAddForm\");","map":{"version":3,"sources":["/opt/lampp/htdocs/git/salonreact/src/pages/products/form/ProductAddForm.js"],"names":["React","useEffect","useState","useDispatch","useSelector","useTranslation","Yup","Formik","config","yupconfig","InputField","SwitchField","InputFieldImage","TextareaField","ReactSelectField","sweatalert","productManageStock","closeAddProductForm","productStoreApi","removeImage","useScriptRef","CustomSelect","ProductAddForm","loading","setLoading","rightDrawerOpened","state","product","isOpenedAddForm","isProductManageStock","isSupplierOption","supplier","isTaxOption","tax","t","dispatch","scriptedRef","handleCloseAddProductForm","type","initialValues","image","name","sku","description","cost_price","retail_price","manage_stock","stock_quantity","low_stock_threshold","tax_id","supplier_id","digitOnly","value","test","decimalOnly","validationSchema","object","shape","mixed","nullable","string","max","label","trim","required","when","is","then","lazy","val","Array","isArray","array","of","min","handleSupplierSubmit","values","setErrors","setStatus","setSubmitting","resetForm","action","meta","requestStatus","success","title","text","icon","status","payload","errors","message","current","err","supplierOptionsData","taxOptionsData","formik","handleSubmit","e","currentTarget","checked","setTimeout","setFieldValue","handleChange","display"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useTranslation } from \"react-i18next\";\n// validation Formik\nimport * as Yup from \"yup\";\nimport { Formik } from \"formik\";\nimport config from \"../../../config\";\nimport yupconfig from \"../../../yupconfig\";\nimport { InputField, SwitchField, InputFieldImage, TextareaField, ReactSelectField } from \"../../../component/form/Field\";\nimport { sweatalert } from \"../../../component/Sweatalert2\";\n\n// import { closeNewSupplierForm } from \"../../../store/slices/supplierSlice\";\nimport { productManageStock, closeAddProductForm, productStoreApi } from \"../../../store/slices/productSlice\";\nimport { removeImage } from \"../../../store/slices/imageSlice\";\nimport useScriptRef from \"../../../hooks/useScriptRef\";\nimport CustomSelect from \"../../../component/form/CustomSelect\";\n\nconst ProductAddForm = () => {\n  const [loading, setLoading] = useState(false);\n  const rightDrawerOpened = useSelector((state) => state.product.isOpenedAddForm);\n  const isProductManageStock = useSelector((state) => state.product.isProductManageStock);\n  const isSupplierOption = useSelector((state) => state.supplier.isSupplierOption);\n  const isTaxOption = useSelector((state) => state.tax.isTaxOption);\n\n  const { t } = useTranslation();\n  const dispatch = useDispatch();\n  const scriptedRef = useScriptRef();\n\n  const handleCloseAddProductForm = () => {\n    dispatch(closeAddProductForm());\n    dispatch({ type: \"product/detail/rejected\" });\n    dispatch(removeImage());\n  };\n\n  const initialValues = {\n    image: \"\",\n    name: \"\",\n    sku: \"\",\n    description: \"\",\n    cost_price: \"\",\n    retail_price: \"\",\n    manage_stock: '',\n    stock_quantity: \"\",\n    low_stock_threshold: \"\",\n    tax_id: \"\",\n    supplier_id: \"\",\n  };\n\n  const digitOnly = (value) => /^\\d+$/.test(value);\n  const decimalOnly = (value) => /^\\d{1,6}(\\.\\d{1,2})?$/.test(value);\n\n  const validationSchema = Yup.object().shape({\n    image: Yup.mixed().nullable(),\n    name: Yup.string().max(100).label(t(\"product_name\")).trim().required(),\n    sku: Yup.string().trim().label(t(\"sku\")).required(),\n    description: Yup.string().trim().label(t(\"description\")).required(),\n    cost_price: Yup.string().trim().label(t(\"cost_price\")).required().test(\"Decimal only\", t(\"The_field_should_have_decimal_only\"), decimalOnly),\n    retail_price: Yup.string().trim().label(t(\"retail_price\")).required().test(\"Decimal only\", t(\"The_field_should_have_decimal_only\"), decimalOnly),\n    manage_stock:Yup.mixed().nullable(),\n    stock_quantity: Yup.string().when(\"manage_stock\", {\n      is: '1',\n      then: Yup.string().trim().label(t(\"stock_quantity\")).required().test(\"Digits only\", t(\"The_field_should_have_digits_only\"), digitOnly).nullable(),\n    }),\n    low_stock_threshold: Yup.string().when(\"manage_stock\", {\n      is: '1',\n      then: Yup.string().trim().label(t(\"low_stock_threshold\")).required().test(\"Digits only\", t(\"The_field_should_have_digits_only\"), digitOnly).nullable(),\n    }),\n    tax_id: Yup.lazy((val) => (Array.isArray(val) ? Yup.array().of(Yup.string()).nullable().min(1).required() : Yup.string().nullable().label(t(\"tax\")).required())),\n    supplier_id: Yup.lazy((val) => (Array.isArray(val) ? Yup.array().of(Yup.string()).nullable().min(1).required() : Yup.string().nullable().label(t(\"supplier\")).required())),\n  });\n  yupconfig();\n\n  const handleSupplierSubmit = (values, { setErrors, setStatus, setSubmitting, resetForm }) => {\n    setLoading(true);\n    try {\n      dispatch(productStoreApi(values)).then((action) => {\n        if (action.meta.requestStatus == \"fulfilled\") {\n          setStatus({ success: true });\n          resetForm();\n          dispatch(removeImage());\n          dispatch(closeAddProductForm());\n          sweatalert({ title: t(\"created\"), text: t(\"created_successfully\"), icon: \"success\" });\n        } else if (action.meta.requestStatus == \"rejected\") {\n          const status = action.payload && action.payload.status;\n          const errors = action.payload && action.payload.message && action.payload.message.errors;\n          if (status == 422) {\n            setErrors(errors);\n          }\n          setStatus({ success: false });\n          setSubmitting(false);\n        }\n      });\n      if (scriptedRef.current) {\n        setLoading(false);\n      }\n    } catch (err) {\n      if (scriptedRef.current) {\n        setErrors(err.message);\n      }\n      setStatus({ success: false });\n      setLoading(false);\n    }\n  };\n\n  const supplierOptionsData = isSupplierOption;\n  const taxOptionsData = isTaxOption;\n\n  return (\n    <React.Fragment>\n      <Formik enableReinitialize={false} initialValues={initialValues} validationSchema={validationSchema} onSubmit={handleSupplierSubmit}>\n        {(formik) => {\n          return (\n            <div className={(rightDrawerOpened ? \"full-screen-drawer p-0 \" : '') + rightDrawerOpened} id=\"addproduct-drawer\">\n              <div className=\"drawer-wrp position-relative\">\n                <form noValidate onSubmit={formik.handleSubmit}>\n                  <div className=\"drawer-header px-md-4 px-3 py-3 d-flex flex-wrap align-items-center\">\n                    <h3 className=\"mb-0 fw-semibold\">{t(\"new_product\")}</h3>\n                    <div className=\"ms-auto\">\n                      <a className=\"close btn me-1 cursor-pointer\" onClick={handleCloseAddProductForm}>\n                        {t(\"cancel\")}\n                      </a>\n                      <button type=\"submit\" className=\"btn\">\n                        {t(\"save\")}\n                      </button>\n                    </div>\n                  </div>\n                  <div className=\"drawer-body\">\n                    <div className=\"col-xxl-6 col-xl-10 col-md-12 mx-auto add-form px-md-4 px-1 py-lg-5 py-3\">\n                      <div className=\"row mx-0\">\n                        <div className=\"col-md-6 ps-md-0 mb-md-0 mb-3\">\n                          <h4 className=\"fw-semibold mb-2\">{t(\"description\")}</h4>\n                          <p>{t(\"add_the_name_and_general_details_of_this_product\")}</p>\n                          <InputFieldImage name=\"image\" accept=\"image/*\" label={t(\"add_product_image\")} page=\"product-form\" controlId=\"productForm-logo\" imagname=\"\" imageurl=\"\"/>\n                        </div>\n                        <div className=\"col-md-6 pe-md-0\">\n                          <div className=\"mb-3\">\n                            <InputField type=\"text\" name=\"name\" value={formik.values.name} label={t(\"product_name\")} controlId=\"productForm-name\" />\n                          </div>\n                          <div className=\"mb-3\">\n                            <InputField type=\"text\" name=\"sku\" value={formik.values.sku} label={t(\"sku\")} controlId=\"productForm-sku\" />\n                          </div>\n                          <div className=\"mb-3\">\n                            <ReactSelectField name=\"supplier_id\" placeholder={t(\"search_option\")} value={formik.values.supplier_id} options={supplierOptionsData} label={t(\"supplier\")} controlId=\"productForm-supplier_id\" isMulti={false} />\n                          </div>\n                          <div className=\"mb-3\">\n                            <TextareaField name=\"description\" value={formik.values.description} label={t(\"description\")} controlId=\"productForm-description\" />\n                          </div>\n                        </div>\n                      </div>\n                      <hr className=\"drawer-supplier-hr\"></hr>\n                      <div className=\"row mx-0\">\n                        <div className=\"col-md-6 ps-md-0 mb-md-0 mb-3\">\n                          <h4 className=\"fw-semibold mb-2\">{t(\"price\")}</h4>\n                          <p>{t(\"add_the_pricing_details_of_this_product\")}</p>\n                        </div>\n                        <div className=\"col-md-6 pe-md-0\">\n                          <div className=\"row\">\n                            <div className=\"mb-2 col-md-4 col-6 mb-3\">\n                              <InputField type=\"text\" name=\"cost_price\" value={formik.values.cost_price} label={t(\"cost_price\")} controlId=\"productForm-cost_price\" />\n                            </div>\n                            <div className=\"mb-2 col-md-4 col-6 mb-3\">\n                              <InputField type=\"text\" name=\"retail_price\" value={formik.values.retail_price} label={t(\"retail_price\")} controlId=\"productForm-retail_price\" />\n                            </div>\n                            <div className=\"col-md-8 mb-3\">\n                              <ReactSelectField name=\"tax_id\" placeholder={t(\"search_option\")} value={formik.values.tax_id} options={taxOptionsData} label={t(\"tax\")} controlId=\"productForm-tax_id\" isMulti={false}  />\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                      <hr className=\"drawer-supplier-hr\"></hr>\n                      <div className=\"row mx-0\">\n                        <div className=\"col-md-6 ps-md-0 mb-md-0 mb-3\">\n                          <h4 className=\"fw-semibold mb-2\">{t(\"inventory\")}</h4>\n                          <p>{t(\"manage_stock_levels_of_this_product\")}</p>\n                        </div>\n                        <div className=\"col-md-6 pe-md-0\">\n                          <SwitchField\n                            name=\"manage_stock\"\n                            label={t(\"manage_stock\")}\n                            controlId=\"clientForm-manage_stock\"\n                            value={'1'}\n                            onChange={(e) => {\n                              if(e.currentTarget.checked){\n                                setTimeout(() => {\n                                  formik.setFieldValue('manage_stock', '1', false);\n                                }, 100);\n                              }else{\n                                setTimeout(() => {\n                                  formik.setFieldValue('manage_stock', '', false);\n                                }, 100);\n                              }\n                              formik.handleChange(e);\n                            }}\n                          />\n                          <div className=\"row\" style={{ display: formik.values.manage_stock == \"\" || formik.values.manage_stock == 0 ? \"none\" : \"\" }}>\n                            <div className=\"mb-3 col-md-6\">\n                              <InputField type=\"text\" name=\"stock_quantity\" value={formik.values.stock_quantity} label={t(\"stock_quantity\")} controlId=\"productForm-stock_quantity\" />\n                            </div>\n                            <div className=\"mb-3 col-md-6\">\n                              <InputField type=\"text\" name=\"low_stock_threshold\" value={formik.values.low_stock_threshold} label={t(\"low_stock_threshold\")} controlId=\"productForm-low_stock_threshold\" />\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </form>\n              </div>\n            </div>\n          );\n        }}\n      </Formik>\n    </React.Fragment>\n  );\n};\n\nexport default ProductAddForm;\n"]},"metadata":{},"sourceType":"module"}